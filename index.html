<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Christmas Tree</title>
<style>
html, body {
  margin: 0;
  padding: 0;
  background: black;
  overflow: hidden;
}
canvas {
  display: block;
  width: 100vw;
  height: 100vh;
}
</style>
</head>

<body>
<canvas id="c"></canvas>

<script>
const canvas = document.getElementById("c");
const ctx = canvas.getContext("2d");

function resize(){
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;

  // é‡æ–°ç”Ÿæˆé›ªèŠ±
  snow = [];
  let snowCount = Math.floor(canvas.width * canvas.height / 5000);
  for(let i=0;i<snowCount;i++){
    snow.push({
      x: Math.random()*canvas.width,
      y: Math.random()*canvas.height,
      r: Math.random()*2 + 0.5,
      s: Math.random()*1 + 0.5
    });
  }

  // é‡æ–°ç”Ÿæˆæ ‘ç²’å­
  tree = [];
  const cx = canvas.width/2;
  const topY = canvas.height*0.15;
  const h = canvas.height*0.6;

  for(let y=0; y<h; y+=canvas.height*0.008){
    let w = y*0.75;
    for(let i=0;i<w;i+=canvas.width*0.015){
      let dx = (Math.random()-0.5)*w;
      tree.push({
        x: cx+dx,
        y: topY+y+Math.random()*4,
        a: Math.random(),
        b: 1-Math.abs(dx)/w
      });
    }
  }

  topYVal = topY;
  hVal = h;
  cxVal = cx;
}
window.addEventListener("resize", resize);
resize();

/* é›ªå’Œæ ‘ç²’å­ */
let snow = [];
let tree = [];
let cxVal, topYVal, hVal;

function draw(){
  ctx.clearRect(0,0,canvas.width,canvas.height);

  /* èƒŒæ™¯ */
  ctx.fillStyle = "black";
  ctx.fillRect(0,0,canvas.width,canvas.height);

  /* é›ª */
  ctx.fillStyle = "white";
  snow.forEach(s=>{
    ctx.beginPath();
    ctx.arc(s.x,s.y,s.r,0,Math.PI*2);
    ctx.fill();
    s.y += s.s;
    if(s.y > canvas.height){
      s.y = 0;
      s.x = Math.random()*canvas.width;
    }
  });

  /* åœ£è¯æ ‘ */
  tree.forEach(p=>{
    let glow = 0.4 + Math.sin(p.a*6)*0.3;
    ctx.fillStyle = `rgba(255,210,210,${glow*p.b})`;
    ctx.beginPath();
    ctx.arc(p.x,p.y,Math.max(canvas.width*0.005,2.4),0,Math.PI*2);
    ctx.fill();
    p.a += 0.02;
  });

  /* é¡¶éƒ¨æ˜Ÿ */
  ctx.fillStyle = "rgba(255,255,220,1)";
  ctx.beginPath();
  ctx.arc(cxVal, topYVal - canvas.height*0.035, canvas.height*0.02, 0, Math.PI*2);
  ctx.fill();

  /* åœ°é¢å…‰ç¯ */
  ctx.strokeStyle = "rgba(255,255,255,0.1)";
  for(let r=canvas.width*0.15; r<canvas.width*0.45; r+=canvas.width*0.05){
    ctx.beginPath();
    ctx.ellipse(cxVal, topYVal+hVal+canvas.height*0.03, r, r*0.25, 0, 0, Math.PI*2);
    ctx.stroke();
  }

  /* åœ£è¯ç¥ç¦æ–‡å­—ï¼ˆé—ªçƒç‰ˆï¼‰ */
  let t = Date.now() * 0.005;
  let r = Math.floor(200 + 55 * Math.sin(t));
  let g = Math.floor(100 + 155 * Math.sin(t + 2));
  let b = Math.floor(200 + 55 * Math.sin(t + 4));

  ctx.fillStyle = `rgb(${r},${g},${b})`;
  ctx.font = `${Math.floor(canvas.height*0.05)}px Arial`;
  ctx.textAlign = "center";

  if(canvas.width < 500){ 
    // æ‰‹æœºå±å¹•æ–‡å­—åˆ†ä¸¤è¡Œ
    ctx.fillText("ğŸ„ åœ£è¯èŠ‚å¿«ä¹ ğŸ„", cxVal, topYVal+hVal + canvas.height*0.08);
    ctx.fillText("è€ƒè¯•åŠ æ²¹ ğŸ„", cxVal, topYVal+hVal + canvas.height*0.13);
  } else {
    ctx.fillText("ğŸ„ åœ£è¯èŠ‚å¿«ä¹ï¼Œè€ƒè¯•åŠ æ²¹ ğŸ„", cxVal, topYVal+hVal + canvas.height*0.1);
  }

  requestAnimationFrame(draw);
}

draw();
</script>
</body>
</html>
